(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e527821c"],{"0c23":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"close-on-click-modal":!1,title:t.adminId?"管理员详情":"生成新管理员",visible:t.dialogFormVisible,size:"mini",width:"400px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.formData}},[t.adminId?a("el-form-item",{attrs:{label:"管理员ID","label-width":"120"}},[a("el-input",{attrs:{disabled:""},model:{value:t.formData.id,callback:function(e){t.$set(t.formData,"id",e)},expression:"formData.id"}})],1):t._e(),a("el-form-item",{attrs:{label:"用户名","label-width":"120"}},[a("el-input",{attrs:{disabled:null!==t.adminId&&void 0!==t.adminId},model:{value:t.formData.userName,callback:function(e){t.$set(t.formData,"userName",e)},expression:"formData.userName"}})],1),a("el-form-item",{attrs:{label:"密码","label-width":"120"}},[a("el-input",{model:{value:t.formData.password,callback:function(e){t.$set(t.formData,"password",e)},expression:"formData.password"}})],1),a("el-form-item",{attrs:{label:"级别","label-width":"120"}},[a("el-select",{attrs:{placeholder:"请输入关键词"},model:{value:t.formData.level,callback:function(e){t.$set(t.formData,"level",e)},expression:"formData.level"}},[a("el-option",{directives:[{name:"permission",rawName:"v-permission",value:["SUPER_MANAGER"],expression:"['SUPER_MANAGER']"}],attrs:{label:"店管理员",value:"SHOP_MANAGER"}}),a("el-option",{directives:[{name:"permission",rawName:"v-permission",value:["SUPER_MANAGER","SHOP_MANAGER"],expression:"['SUPER_MANAGER','SHOP_MANAGER']"}],attrs:{label:"接单员",value:"RECEIVER"}}),a("el-option",{directives:[{name:"permission",rawName:"v-permission",value:["SUPER_MANAGER","SHOP_MANAGER"],expression:"['SUPER_MANAGER','SHOP_MANAGER']"}],attrs:{label:"外卖员",value:"DELIVERER"}})],1)],1),a("el-form-item",{directives:[{name:"permission",rawName:"v-permission",value:["SUPER_MANAGER"],expression:"['SUPER_MANAGER']"}],attrs:{label:"店铺Id","label-width":"120"}},[a("el-input",{model:{value:t.formData.storeId,callback:function(e){t.$set(t.formData,"storeId",e)},expression:"formData.storeId"}})],1),a("el-form-item",{attrs:{label:"状态","label-width":"120"}},[a("el-select",{attrs:{placeholder:"请输入关键词"},model:{value:t.formData.state,callback:function(e){t.$set(t.formData,"state",e)},expression:"formData.state"}},[a("el-option",{attrs:{label:"冻结",value:"STOP"}}),a("el-option",{attrs:{label:"正常",value:"NORMAL"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t.adminId?a("el-button",{attrs:{type:"primary"},on:{click:t.onEdit}},[t._v("修 改")]):a("el-button",{attrs:{type:"success"},on:{click:t.onSave}},[t._v("生 成")])],1)],1)},n=[],r=(a("d3b7"),a("50fc")),o=a("4381"),s={name:"AdminDialog",directives:{permission:o["a"]},data:function(){return{dialogFormVisible:!1,adminId:null,formData:{id:null,storeId:null,userName:null,password:null,level:null,state:null},loading:!1}},watch:{dialogFormVisible:function(){this.dialogFormVisible?this.init():this.formData=this.$options.data().formData}},methods:{init:function(){var t=this;this.adminId&&(this.loading=!0,r["a"].getAdminInfoById(this.adminId).then((function(e){t.formData=e})).finally((function(e){t.loading=!1})))},openDialog:function(t,e){this.adminId=t,this.formData.storeId=e,this.dialogFormVisible=!0},onEdit:function(){var t=this;r["a"].updateAdmin(this.formData).then((function(e){t.$message.success(e.message),t.$emit("updated-admin",t.formData)}))},onSave:function(){var t=this;r["a"].createNewSubAdmin(this.formData).then((function(e){t.$message.success(e.message),t.$emit("updated-admin",t.formData)}))}}},l=s,d=a("2877"),c=Object(d["a"])(l,i,n,!1,null,"846f509e",null);e["a"]=c.exports},"2f94":function(t,e,a){"use strict";var i=a("b775"),n=a("4328"),r=a.n(n);function o(t,e){var a=Object.assign({},t,e);return Object(i["a"])({url:"/address/getAddressListByPage",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:a,transformRequest:[function(t){return t=r.a.stringify(t),t}]})}function s(t){return Object(i["a"])({url:"/address/getAddressById",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{addressId:t},transformRequest:[function(t){return t=r.a.stringify(t),t}]})}function l(t){return Object(i["a"])({url:"/address/searchAddress",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{address:t},transformRequest:[function(t){return t=r.a.stringify(t),t}]})}function d(t){return Object(i["a"])({url:"/address/updateAddress",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:t,transformRequest:[function(t){return t=r.a.stringify(t),t}]})}e["a"]={getAddressListByPage:o,getAddressById:s,searchAddress:l,updateAddress:d}},"360b":function(t,e,a){"use strict";var i=a("b8ef"),n=a.n(i);n.a},4381:function(t,e,a){"use strict";a("caad"),a("45fc"),a("2532");var i=a("4360"),n={inserted:function(t,e,a){var n=e.value,r=i["a"].getters&&i["a"].getters.roles;if(!(n&&n instanceof Array&&n.length>0))throw new Error("need roles! Like v-permission=\"['admin','editor']\"");var o=n,s=r.some((function(t){return o.includes(t)}));s||t.parentNode&&t.parentNode.removeChild(t)}},r=function(t){t.directive("permission",n)};window.Vue&&(window["permission"]=n,Vue.use(r)),n.install=r;e["a"]=n},"73f5":function(t,e,a){"use strict";var i=a("b775"),n=a("4328"),r=a.n(n);function o(t){return Object(i["a"])({url:"/store/getStoreById",method:"post",data:{storeId:t},transformRequest:[function(t){return t=r.a.stringify(t),t}]})}function s(){return Object(i["a"])({url:"/store/getStoreQRcode",method:"get"})}function l(t,e){var a=Object.assign({},t,e);return Object(i["a"])({url:"/store/getListByPage",method:"post",data:a,transformRequest:[function(t){return t=r.a.stringify(t),t}]})}function d(t){return Object(i["a"])({url:"/store/create",method:"post",data:t,transformRequest:[function(t){return t=r.a.stringify(t),t}]})}function c(t){return Object(i["a"])({url:"/store/update",method:"post",data:t,transformRequest:[function(t){return t=r.a.stringify(t),t}]})}e["a"]={getStoreById:o,getStoreQRcode:s,getListByPage:l,create:d,update:c}},"7db0":function(t,e,a){"use strict";var i=a("23e7"),n=a("b727").find,r=a("44d2"),o=a("ae40"),s="find",l=!0,d=o(s);s in[]&&Array(1)[s]((function(){l=!1})),i({target:"Array",proto:!0,forced:l||!d},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),r(s)},b8ef:function(t,e,a){},bb50:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("base-card",{staticClass:"container-header"},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formData,size:"mini"}},[a("el-form-item",{attrs:{label:"级别"}},[a("el-input",{model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSearch}},[t._v("查询")])],1)],1)],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[a("el-button",{attrs:{size:"mini",type:"success"},on:{click:t.onCreate}},[t._v("添加新店铺")])],1)],1)],1),a("base-card",{staticClass:"container-main"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"tb-edit",staticStyle:{width:"100%"},attrs:{data:t.tableData,"element-loading-text":"正在加载中...","highlight-current-row":"",stripe:""}},[a("el-table-column",{attrs:{align:"center",label:"ID",prop:"id",width:"200"}}),a("el-table-column",{attrs:{align:"center",label:"名称",prop:"name",width:"200"}}),a("el-table-column",{attrs:{align:"center",label:"收费方式",prop:"paymentWay",width:"200"}}),a("el-table-column",{attrs:{align:"center",label:"余额",prop:"balance",width:"200"}}),a("el-table-column",{attrs:{align:"center",label:"到期时间",prop:"expireDate",width:"200"}}),a("el-table-column",{attrs:{align:"center",label:"状态",prop:"state",width:"200"}}),a("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"createDate"}}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.onEdit(e.row.id)}}},[t._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.onCreateAdmin(e.row.id)}}},[t._v("添加管理员")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"15px"},attrs:{"current-page":t.page.current,"page-size":t.page.size,"page-sizes":[15,50,100],total:t.page.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1),a("store-dialog",{ref:"store-dialog",on:{"updated-store":t.onUpdatedStore}}),a("admin-dialog",{ref:"admin-dialog"})],1)},n=[],r=a("a145"),o=a("0c23"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"close-on-click-modal":!1,title:t.storeId?"店铺详情":"生成店铺",visible:t.dialogFormVisible,size:"mini",width:"400px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.formData}},[t.storeId?a("el-form-item",{attrs:{label:"店铺ID","label-width":"70px"}},[a("el-input",{attrs:{disabled:""},model:{value:t.formData.id,callback:function(e){t.$set(t.formData,"id",e)},expression:"formData.id"}})],1):t._e(),a("el-form-item",{attrs:{label:"店铺名","label-width":"70px"}},[a("el-input",{attrs:{disabled:null!==t.storeId&&void 0!==t.storeId},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"店铺地址"}},[a("el-select",{staticStyle:{display:"block"},attrs:{loading:t.searchLoading,"remote-method":t.onSearch,filterable:"",placeholder:"请输入关键词",remote:"","reserve-keyword":""},on:{change:t.onSelect},model:{value:t.formData.address,callback:function(e){t.$set(t.formData,"address",e)},expression:"formData.address"}},t._l(t.addressList,(function(t){return a("el-option",{key:t.address,attrs:{label:t.address,value:t.address}})})),1)],1),a("el-form-item",{attrs:{label:"地址经度"}},[a("el-input",{attrs:{disabled:""},model:{value:t.formData.x,callback:function(e){t.$set(t.formData,"x",e)},expression:"formData.x"}})],1),a("el-form-item",{attrs:{label:"地址纬度"}},[a("el-input",{attrs:{disabled:""},model:{value:t.formData.y,callback:function(e){t.$set(t.formData,"y",e)},expression:"formData.y"}})],1),a("el-form-item",{attrs:{label:"支付方式","label-width":"70px"}},[a("el-select",{attrs:{placeholder:"请选择关键字"},model:{value:t.formData.paymentWay,callback:function(e){t.$set(t.formData,"paymentWay",e)},expression:"formData.paymentWay"}},[a("el-option",{attrs:{label:"免费",value:"FREE"}}),a("el-option",{attrs:{label:"按量计费",value:"PAY_AS_YOU_GO"}}),a("el-option",{attrs:{label:"包月",value:"MONTH"}})],1)],1),a("el-form-item",{attrs:{label:"到期时间","label-width":"70px"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",disabled:"MONTH"!==t.formData.paymentWay,"value-format":"yyyy-MM-dd"},model:{value:t.formData.expireDate,callback:function(e){t.$set(t.formData,"expireDate",e)},expression:"formData.expireDate"}})],1),a("el-form-item",{attrs:{label:"状态","label-width":"70px"}},[a("el-select",{attrs:{placeholder:"请输入关键词"},model:{value:t.formData.state,callback:function(e){t.$set(t.formData,"state",e)},expression:"formData.state"}},[a("el-option",{attrs:{label:"停止",value:"OFF"}}),a("el-option",{attrs:{label:"正常",value:"ON"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t.storeId?a("el-button",{attrs:{type:"primary"},on:{click:t.onEdit}},[t._v("修 改")]):a("el-button",{attrs:{type:"success"},on:{click:t.onSave}},[t._v("生 成")])],1)],1)},l=[],d=(a("7db0"),a("d3b7"),a("73f5")),c=a("4381"),u=a("2f94"),m={name:"StoreDialog",directives:{permission:c["a"]},data:function(){return{dialogFormVisible:!1,storeId:null,formData:{id:null,name:null,address:"",x:null,y:null,paymentWay:null,expireDate:null,state:null},loading:!1,searchLoading:!1,addressList:[]}},watch:{dialogFormVisible:function(){this.dialogFormVisible?this.init():this.formData=this.$options.data().formData}},methods:{init:function(){var t=this;this.storeId&&(this.loading=!0,d["a"].getStoreById(this.storeId).then((function(e){t.formData=e})).finally((function(){t.loading=!1})))},openDialog:function(t){this.storeId=t,this.dialogFormVisible=!0},onEdit:function(){var t=this;d["a"].update(this.formData).then((function(e){t.$message({message:e.message,type:"success"}),t.$emit("updated-store",t.formData)}))},onSave:function(){var t=this;d["a"].create(this.formData).then((function(e){t.$message({message:e.message,type:"success"}),t.$emit("updated-store",t.formData)}))},onSearch:function(t){var e=this;""!==t?(this.searchLoading=!0,u["a"].searchAddress(t).then((function(t){e.addressList=t})).catch((function(){e.addressList=[]})).finally((function(){e.searchLoading=!1}))):this.addressList=[]},onSelect:function(t){var e=this.addressList.find((function(e){return e.address===t}));this.formData.address=e.address,this.formData.x=e.x,this.formData.y=e.y}}},f=m,p=a("2877"),h=Object(p["a"])(f,s,l,!1,null,"7874a670",null),b=h.exports,g={name:"StoreManagement",components:{BaseCard:r["a"],AdminDialog:o["a"],StoreDialog:b},data:function(){return{page:{current:1,size:15,total:0},formData:{type:null,state:null},listLoading:!1,tableData:[]}},created:function(){this.onSearch()},methods:{getList:function(){var t=this;this.listLoading=!0,d["a"].getListByPage(this.page,this.formData).then((function(e){t.tableData=e.records,t.page.total=parseInt(e.total),t.listLoading=!1})).catch((function(){t.listLoading=!1}))},handleSizeChange:function(t){this.page.size=t,this.getList()},handleCurrentChange:function(t){this.page.current=t,this.getList()},onSearch:function(){this.page.current=1,this.getList()},onCreate:function(){this.$refs["store-dialog"].openDialog()},onEdit:function(t){this.$refs["store-dialog"].openDialog(t)},onCreateAdmin:function(t){this.$refs["admin-dialog"].openDialog(null,t)},onUpdatedStore:function(){this.onSearch()}}},v=g,D=(a("360b"),Object(p["a"])(v,i,n,!1,null,"3a6e8ac9",null));e["default"]=D.exports}}]);