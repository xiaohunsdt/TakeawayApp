(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7599aae2"],{"037c":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"map-container"},[n("naver-map")],1)},i=[],a=n("555e"),o={name:"OrderMap",components:{NaverMap:a["a"]}},s=o,c=(n("65f8"),n("2877")),u=Object(c["a"])(s,r,i,!1,null,"879eacd0",null);e["default"]=u.exports},"178e":function(t,e,n){"use strict";var r=n("b775"),i=n("4328"),a=n.n(i);function o(){return Object(r["a"])({url:"/setting/getAllSetting",method:"get"})}function s(t,e){return Object(r["a"])({url:"/setting/getSettingByKey",method:"post",data:{key:t,scope:e},headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return t=a.a.stringify(t),t}]})}function c(t){return Object(r["a"])({url:"/setting/getSettingsByScope",method:"post",data:{scope:t},headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return t=a.a.stringify(t),t}]})}function u(t,e){t.scope=e;var n=t;return Object(r["a"])({url:"/setting/updateSetting",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:n,transformRequest:[function(t){return t=a.a.stringify(t),t}]})}e["a"]={getAllSetting:o,getSettingByKey:s,getSettingsByScope:c,updateSetting:u}},"39e8":function(t,e,n){},"555e":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.mapOptions.lat&&t.mapOptions.lng?n("naver-maps",{attrs:{height:t.height,initLayers:t.initLayers,mapOptions:t.mapOptions},on:{load:t.onLoad}},[n("map-info-window",{ref:"info-window",staticClass:"info-window",attrs:{isOpen:t.isOpen,marker:t.marker},on:{load:t.onWindowLoad}},[t.selectedOrder?n("div",{staticClass:"info-window-container"},[n("base-card",[n("div",[t._v(" "+t._s(t.selectedOrder.address.address)+" "+t._s(t.selectedOrder.address.detail)+" "),n("br"),t._v(" "+t._s(t.selectedOrder.address.phone)+" ")]),n("div",{staticStyle:{"margin-top":"8px"}},[n("el-button-group",[n("el-button",{attrs:{size:"mini",type:"primary"}},[n("a",{attrs:{href:"nmap://search?appname=http://admin.cxy.novaborn.net&query="+t.selectedOrder.address.address}},[t._v("打开地图")])]),n("el-button",{attrs:{size:"mini",type:"primary"}},[n("a",{attrs:{href:"tel:"+t.selectedOrder.address.phone}},[t._v("拨打手机")])]),n("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.onFinishOrder(t.selectedOrder)}}},[t._v(" 完成订单 ")])],1)],1)])],1):t._e()]),n("map-marker",{attrs:{lat:t.mapOptions.lat,lng:t.mapOptions.lng},on:{click:t.onMarkerClicked,load:t.onMarkerLoaded}}),t._l(t.orderList,(function(e){return n("map-marker",{key:e.id,attrs:{icon:{content:"<div class='pin-number'>"+e.number+"</div><div class='pin "+e.orderState+"'></div><div class='pulse'></div>"},lat:e.address.y,lng:e.address.x,order:e},on:{click:t.onMarkerClicked,load:t.onMarkerLoaded}})})),t._l(t.distancePriceArr,(function(e){return n("naver-circle",{key:e.key,attrs:{lat:t.mapOptions.lat,lng:t.mapOptions.lng,radius:e.key}})}))],2):t._e()},i=[],a=(n("d81d"),n("a9e3"),n("2909")),o=n("5530"),s=n("5c96"),c=n("a145"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"content"},[t._t("default")],2)},d=[],l={name:"MapInfoWindow",props:{marker:Object,isOpen:Boolean},watch:{isOpen:function(t){t?this.infoWindow.open(this.map,this.marker):this.infoWindow.close(),this.$emit(t?"open":"close",this)}},data:function(){return{infoWindow:null,map:null}},methods:{open:function(t){this.infoWindow.open(this.map,t)},close:function(){this.infoWindow.close()}},mounted:function(){var t=this,e=function(e){console.log(e),t.map=e,t.infoWindow=new window.naver.maps.InfoWindow({content:t.$refs.content,borderWidth:0,backgroundColor:"transparent",disableAnchor:!0}),t.$emit("load",t)};window.$naverMapsLoaded?e(window.$naverMapsObject):window.$naverMapsCallback.push(e)},destroyed:function(){this.infoWindow.setMap(null)}},p=l,f=n("2877"),m=Object(f["a"])(p,u,d,!1,null,null,null),h=m.exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._t("default")],2)},O=[];n("4160");function k(t,e,n){naver.maps.Event.addListener(e,n,(function(e){return t.$emit(n,e)}))}function v(t,e,n,r){naver.maps.Event.addListener(e,n,(function(e){return t.$emit(n,{event:e,order:r})}))}var w={name:"MapMarker",props:{order:Object,otherOptions:Object,lat:{type:Number,required:!0},lng:{type:Number,required:!0},icon:Object},data:function(){return{marker:null,map:null}},watch:{lat:function(){this.setPosition({lng:this.lng,lat:this.lat})},lng:function(){this.setPosition({lng:this.lng,lat:this.lat})}},methods:{setClickable:function(t){return this.marker.setClickable(t),this},setCursor:function(t){return this.marker.setCursor(t),this},setDraggable:function(t){return this.marker.setDraggable(t),this},draw:function(){return this.marker.draw()},getAnimation:function(){return this.marker.getAnimation()},getClickable:function(){return this.marker.getClickable()},getCursor:function(){return this.marker.getCursor()},getDraggable:function(){return this.marker.getDraggable()},getDrawingRect:function(){return this.marker.getDrawingRect()},getIcon:function(){return this.marker.getIcon()},getOptions:function(t){return this.marker.getOptions(t)},getPosition:function(){return this.marker.getPosition()},getShape:function(){return this.marker.getShape()},getTitle:function(){return this.marker.getTitle()},getVisible:function(){return this.marker.getVisible()},getZIndex:function(){return this.marker.getZIndex()},onAdd:function(){return this.marker.onAdd()},onRemove:function(){return this.marker.onRemove()},setAnimation:function(t){return this.marker.setAnimation(naver.maps.Animation[t]),this},setIcon:function(t){return this.marker.setIcon(t),this},setOptions:function(t){return this.marker.setOptions(t),this},setPosition:function(t){return this.marker.setPosition(t),this},setShape:function(t){return this.marker.setShape(t),this},setTitle:function(t){return this.marker.setTitle(t),this},setVisible:function(t){return this.marker.setVisible(t),this},setZIndex:function(t){return this.marker.setZIndex(t),this}},mounted:function(){var t=this,e=function(e){t.map=e,t.marker=new window.naver.maps.Marker(Object.assign({position:new window.naver.maps.LatLng(t.lat,t.lng),map:e},t.otherOptions,t.icon?{icon:t.icon}:{}));var n=["mousedown","mouseup","dblclick","rightclick","mouseover","mouseout","mousemove","dragstart","drag","dragend","touchstart","touchmove","touchend","pinchstart","pinch","pinchend","tap","longtap","twofingertap","doubletap"];n.forEach((function(e){return k(t,t.marker,e)})),v(t,t.marker,"click",t.order),t.$emit("load",t)};window.$naverMapsLoaded?e(window.$naverMapsObject):window.$naverMapsCallback.push(e)},destroyed:function(){this.marker.setMap(null)}},y=w,b=Object(f["a"])(y,g,O,!1,null,null,null),L=b.exports,C=n("f8b7"),_=n("178e"),S=n("73f5"),j=n("2f62"),M={name:"NaverMap",components:{BaseCard:c["a"],MapInfoWindow:h,MapMarker:L},props:{height:{type:Number,default:1e3},allOrder:{type:Boolean,default:!1}},data:function(){return{selectedOrder:null,isOpen:!1,marker:null,map:null,mapOptions:{lat:null,lng:null,zoom:14,zoomControl:!0,zoomControlOptions:{position:"CENTER"},mapTypeControl:!0},distancePriceArr:[],initLayers:["BACKGROUND","BACKGROUND_DETAIL","POI_KOREAN","TRANSIT","CHINESE"],orderList:[],timer:null}},computed:Object(o["a"])({},Object(j["b"])(["userData"])),created:function(){var t=this;this.allOrder?this.getAllTodayOrderList():(this.getWaitEatOrderList(),this.timer=setInterval(this.getWaitEatOrderList,6e4)),S["a"].getStoreById(this.userData.storeId).then((function(e){t.mapOptions.lng=e.x,t.mapOptions.lat=e.y})),_["a"].getSettingByKey("distance_price_arr","DELIVERY").then((function(e){var n;e&&(n=t.distancePriceArr).push.apply(n,Object(a["a"])(JSON.parse(e.value)))})),_["a"].getSettingByKey("max_delivery_distance","DELIVERY").then((function(e){e&&t.distancePriceArr.push({key:parseFloat(e.value)})}))},methods:{onLoad:function(t){this.map=t},onWindowLoad:function(t){console.log(t),t.infoWindow.borderWidth=0},onMarkerClicked:function(t){console.log(this.$refs),t.order?this.selectedOrder=t.order:this.selectedOrder=null,this.marker!==t.event.overlay?(this.$refs["info-window"].close(),this.$refs["info-window"].open(t.event.overlay),this.marker=t.event.overlay,this.isOpen=!0):(this.marker=t.event.overlay,this.isOpen=!this.isOpen)},onMarkerLoaded:function(t){this.marker=t.marker},getWaitEatOrderList:function(){var t=this;C["a"].getTodayOrderListByState("WAIT_EAT").then((function(e){t.orderList=e}))},getAllTodayOrderList:function(){var t=this;C["a"].getTodayOrderList().then((function(e){t.orderList=e}))},onCopySuccess:function(){Object(s["Message"])({message:"复制成功",type:"success",duration:2e3})},onCopyError:function(){Object(s["Message"])({message:"复制失败",type:"error",duration:2e3})},onFinishOrder:function(t){var e=this;this.$confirm("确定当前订单已完成?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){C["a"].finishOrder(t.id).then((function(t){e.$message.success(t.message),e.isOpen=!1,e.allOrder?e.getAllTodayOrderList():e.getWaitEatOrderList()}))}))}},beforeDestroy:function(){clearInterval(this.timer)}},I=M,A=(n("8107"),Object(f["a"])(I,r,i,!1,null,null,null));e["a"]=A.exports},"65f8":function(t,e,n){"use strict";var r=n("39e8"),i=n.n(r);i.a},"73f5":function(t,e,n){"use strict";var r=n("b775"),i=n("4328"),a=n.n(i);function o(t){return Object(r["a"])({url:"/store/getStoreById",method:"post",data:{storeId:t},transformRequest:[function(t){return t=a.a.stringify(t),t}]})}function s(){return Object(r["a"])({url:"/store/getStoreQRcode",method:"get"})}function c(t,e){var n=Object.assign({},t,e);return Object(r["a"])({url:"/store/getListByPage",method:"post",data:n,transformRequest:[function(t){return t=a.a.stringify(t),t}]})}function u(t){return Object(r["a"])({url:"/store/create",method:"post",data:t,transformRequest:[function(t){return t=a.a.stringify(t),t}]})}function d(t){return Object(r["a"])({url:"/store/update",method:"post",data:t,transformRequest:[function(t){return t=a.a.stringify(t),t}]})}e["a"]={getStoreById:o,getStoreQRcode:s,getListByPage:c,create:u,update:d}},8107:function(t,e,n){"use strict";var r=n("b8d2"),i=n.n(r);i.a},b8d2:function(t,e,n){}}]);