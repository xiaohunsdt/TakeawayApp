(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6516962d"],{"0cba":function(e,t,a){"use strict";var o=a("4beb"),n=a.n(o);n.a},"4beb":function(e,t,a){},"4e5c":function(e,t,a){"use strict";var o=a("e1f2"),n=a.n(o);n.a},"8b0a":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("base-card",{staticClass:"container-main"},[a("div",{staticStyle:{display:"flex","justify-content":"center"}},[a("el-form",{ref:"form",staticStyle:{display:"flex","justify-content":"center",width:"920px"},attrs:{model:e.formData,"label-width":"120px"}},[a("div",{staticStyle:{width:"460px"}},[a("el-form-item",{attrs:{rules:{required:!0,message:"请输入标题",trigger:"blur"},label:"优惠卷名称",prop:"couponName"}},[a("el-input",{model:{value:e.formData.couponName,callback:function(t){e.$set(e.formData,"couponName",t)},expression:"formData.couponName"}})],1),a("el-form-item",{attrs:{label:"优惠卷类型"}},[a("el-select",{attrs:{placeholder:"请选择优惠卷类型"},model:{value:e.formData.couponType,callback:function(t){e.$set(e.formData,"couponType",t)},expression:"formData.couponType"}},[a("el-option",{attrs:{label:"现金卷",value:"MONEY"}}),a("el-option",{attrs:{label:"折扣卷",value:"DISCOUNT"}})],1)],1),"MONEY"===e.formData.couponType?a("el-form-item",{attrs:{label:"优惠卷面值"}},[a("el-input",{model:{value:e.formData.couponMoney,callback:function(t){e.$set(e.formData,"couponMoney",e._n(t))},expression:"formData.couponMoney"}})],1):e._e(),"DISCOUNT"===e.formData.couponType?a("el-form-item",{attrs:{label:"优惠卷折扣"}},[a("el-input",{model:{value:e.formData.couponDiscount,callback:function(t){e.$set(e.formData,"couponDiscount",e._n(t))},expression:"formData.couponDiscount"}})],1):e._e(),a("el-form-item",{attrs:{label:"最低消费"}},[a("el-input",{model:{value:e.formData.minimumMoney,callback:function(t){e.$set(e.formData,"minimumMoney",e._n(t))},expression:"formData.minimumMoney"}})],1),a("el-form-item",{attrs:{label:"过期天数"}},[a("el-input",{model:{value:e.formData.expireDays,callback:function(t){e.$set(e.formData,"expireDays",e._n(t))},expression:"formData.expireDays"}})],1)],1),a("el-divider",{attrs:{direction:"vertical"}}),a("div",{staticStyle:{width:"460px"}},[a("dynamic-input",{attrs:{"model-array":e.formData.allowCategory,label:"允许的分类","rule-model-name":"allowCategory"},on:{"update:modelArray":function(t){return e.$set(e.formData,"allowCategory",t)},"update:model-array":function(t){return e.$set(e.formData,"allowCategory",t)}}}),a("dynamic-input",{attrs:{"model-array":e.formData.limitCategory,label:"禁止的分类","rule-model-name":"limitCategory"},on:{"update:modelArray":function(t){return e.$set(e.formData,"limitCategory",t)},"update:model-array":function(t){return e.$set(e.formData,"limitCategory",t)}}}),a("dynamic-input",{attrs:{"model-array":e.formData.allowGoods,label:"禁止的商品","rule-model-name":"allowGoods"},on:{"update:modelArray":function(t){return e.$set(e.formData,"allowGoods",t)},"update:model-array":function(t){return e.$set(e.formData,"allowGoods",t)}}}),a("dynamic-input",{attrs:{"model-array":e.formData.limitGoods,label:"允许的商品","rule-model-name":"limitGoods"},on:{"update:modelArray":function(t){return e.$set(e.formData,"limitGoods",t)},"update:model-array":function(t){return e.$set(e.formData,"limitGoods",t)}}})],1)],1)],1),a("div",{staticStyle:{"text-align":"center","margin-top":"15px"}},[a("el-button",{attrs:{round:"",size:"medium",type:"success"},on:{click:e.saveTemplate}},[e._v("保存")])],1)])],1)},n=[],r=(a("4160"),a("159b"),a("ed08")),l=a("c5bb"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dynamic-input"},[0===e.modelArray.length?a("el-form-item",{attrs:{label:e.label}},[a("el-button",{attrs:{circle:"",icon:"el-icon-plus",size:"mini",type:"success"},on:{click:function(t){return t.preventDefault(),e.addModel(t)}}})],1):e._e(),e._l(e.modelArray,(function(t,o){return a("el-form-item",{key:t.key,attrs:{label:e.label+"("+o+")",prop:e.ruleModelName+"."+o+".value",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[a("el-input",{on:{change:e.onValueChanged},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"model.value"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-delete"},on:{click:function(a){return a.preventDefault(),e.removeModel(t)}},slot:"append"})],1)],1)})),a("div",{staticStyle:{"text-align":"center"}},[e.modelArray.length>0?a("el-button",{attrs:{circle:"",icon:"el-icon-plus",size:"mini",type:"success"},on:{click:function(t){return t.preventDefault(),e.addModel(t)}}}):e._e()],1)],2)},u=[],m=(a("c975"),a("a434"),{name:"DynamicInput",props:{modelArray:{type:Array,required:!0},label:{type:String,required:!0},ruleModelName:{type:String,required:!0}},methods:{onValueChanged:function(e){this.$emit("update:modelArray",this.modelArray)},addModel:function(){this.modelArray.push({key:(new Date).getTime(),value:""})},removeModel:function(e){var t=this.modelArray.indexOf(e);-1!==t&&this.modelArray.splice(t,1)}}}),s=m,c=(a("a7e0"),a("0cba"),a("2877")),d=Object(c["a"])(s,i,u,!1,null,"49096707",null),p=d.exports,f=a("a145"),y={name:"CouponTemplateEditManagement",components:{BaseCard:f["a"],DynamicInput:p},activated:function(){var e=this,t=Object(r["h"])();this.init(),t.templateId&&l["a"].getTemplateById(t.templateId).then((function(t){var a=Object.assign({},t);a.allowCategory=[],a.limitCategory=[],a.allowGoods=[],a.limitGoods=[],t.allowCategory instanceof Array&&t.allowCategory.forEach((function(e){a.allowCategory.push({key:(new Date).getTime()+Math.round(1e4*Math.random()),value:e})})),t.limitCategory instanceof Array&&t.limitCategory.forEach((function(e){a.limitCategory.push({key:(new Date).getTime()+Math.round(1e4*Math.random()),value:e})})),t.allowGoods instanceof Array&&t.allowGoods.forEach((function(e){a.allowGoods.push({key:(new Date).getTime()+Math.round(1e4*Math.random()),value:e})})),t.limitGoods instanceof Array&&t.limitGoods.forEach((function(e){a.limitGoods.push({key:(new Date).getTime()+Math.round(1e4*Math.random()),value:e})})),e.formData=a}))},data:function(){return{formData:{id:null,couponName:"",couponType:"MONEY",couponMoney:0,couponDiscount:0,minimumMoney:0,expireDays:0,allowCategory:[],limitCategory:[],allowGoods:[],limitGoods:[]}}},methods:{init:function(){this.formData.couponName="",this.formData.couponType="MONEY",this.formData.couponMoney=0,this.formData.couponDiscount=0,this.formData.minimumMoney=0,this.formData.expireDays=0,this.formData.allowCategory=[],this.formData.limitCategory=[],this.formData.allowGoods=[],this.formData.limitGoods=[]},saveTemplate:function(){var e=this;this.$refs.form.validate((function(t){t&&l["a"].createNewTemplate(e.formData).then((function(t){e.formData.id||e.init(),e.$message({message:t.message,type:"success"})}))}))}}},D=y,g=(a("4e5c"),Object(c["a"])(D,o,n,!1,null,"6712cf3a",null));t["default"]=g.exports},a7e0:function(e,t,a){"use strict";var o=a("c277"),n=a.n(o);n.a},c277:function(e,t,a){},c5bb:function(e,t,a){"use strict";a("a15b"),a("d81d");var o=a("b775"),n=a("4328"),r=a.n(n);function l(e){return Object(o["a"])({url:"/coupon/template/getTemplateById",params:{id:e}})}function i(e,t){var a=Object.assign({},e,t);return Object(o["a"])({url:"/coupon/template/getTemplateListByPage",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:a,transformRequest:[function(e){return e=r.a.stringify(e),e}]})}function u(){return Object(o["a"])({url:"/coupon/template/getAllTemplateList",method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function m(e){var t=Object.assign({},e);return t.allowCategory=t.allowCategory.map((function(e){return e.value})).join(),t.limitCategory=t.limitCategory.map((function(e){return e.value})).join(),t.allowGoods=t.allowGoods.map((function(e){return e.value})).join(),t.limitGoods=t.limitGoods.map((function(e){return e.value})).join(),Object(o["a"])({url:"/coupon/template/createNewTemplate",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:t,transformRequest:[function(e){return e=r.a.stringify(e),e}]})}function s(e){return Object(o["a"])({url:"/coupon/template/updateTemplate",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:e,transformRequest:[function(e){return e=r.a.stringify(e),e}]})}function c(e){return Object(o["a"])({url:"/coupon/template/deleteTemplate",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{id:e},transformRequest:[function(e){return e=r.a.stringify(e),e}]})}t["a"]={getTemplateById:l,getTemplateListByPage:i,getAllTemplateList:u,createNewTemplate:m,updateTemplate:s,deleteTemplate:c}},e1f2:function(e,t,a){}}]);